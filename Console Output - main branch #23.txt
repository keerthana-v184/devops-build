Started by GitHub push by keerthana-v184
Lightweight checkout support not available, falling back to full checkout.
Checking out git https://github.com/keerthana-v184/devops-build.git into /var/lib/jenkins/workspace/React-App-Deployment@script/f0e58fb5f3902d9418d05e5e6c851630f02e28fe28d4f90ed8620eee35e06a00 to read Jenkinsfile
The recommended git tool is: NONE
using credential github-credentials
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/React-App-Deployment@script/f0e58fb5f3902d9418d05e5e6c851630f02e28fe28d4f90ed8620eee35e06a00/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/keerthana-v184/devops-build.git # timeout=10
Fetching upstream changes from https://github.com/keerthana-v184/devops-build.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
using GIT_ASKPASS to set credentials github-credentials
 > git fetch --tags --force --progress -- https://github.com/keerthana-v184/devops-build.git +refs/heads/*:refs/remotes/origin/* # timeout=10
Seen branch in repository origin/dev
Seen branch in repository origin/main
Seen 2 remote branches
 > git show-ref --tags -d # timeout=10
Checking out Revision 309d3430503ccb8ce3db3406075cadf2c4dd650f (origin/main, origin/dev)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 309d3430503ccb8ce3db3406075cadf2c4dd650f # timeout=10
Commit message: "testing"
 > git rev-list --no-walk eebc30ec44b9ca1cf56d299c2498a7db28ebddb0 # timeout=10
 > git rev-list --no-walk 309d3430503ccb8ce3db3406075cadf2c4dd650f # timeout=10
[Pipeline] Start of Pipeline
[Pipeline] node
Running on node-react-agent in /home/ubuntu/jenkins-agent/workspace/React-App-Deployment
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
The recommended git tool is: NONE
using credential github-credentials
Cloning the remote Git repository
Avoid second fetch
Checking out Revision 309d3430503ccb8ce3db3406075cadf2c4dd650f (origin/main, origin/dev)
Commit message: "testing"
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Checkout Code)
[Pipeline] checkout
The recommended git tool is: NONE
using credential github-credentials
Fetching changes from the remote Git repository
Checking out Revision 309d3430503ccb8ce3db3406075cadf2c4dd650f (origin/main, origin/dev)
Commit message: "testing"
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Setup Image Tag)
[Pipeline] script
[Pipeline] {
Cloning repository https://github.com/keerthana-v184/devops-build.git
 > git init /home/ubuntu/jenkins-agent/workspace/React-App-Deployment # timeout=10
Fetching upstream changes from https://github.com/keerthana-v184/devops-build.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
using GIT_ASKPASS to set credentials github-credentials
 > git fetch --tags --force --progress -- https://github.com/keerthana-v184/devops-build.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.com/keerthana-v184/devops-build.git # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
Seen branch in repository origin/dev
Seen branch in repository origin/main
Seen 2 remote branches
 > git show-ref --tags -d # timeout=10
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 309d3430503ccb8ce3db3406075cadf2c4dd650f # timeout=10
[Pipeline] echo
Using Docker Image: docker.io/iamkeerthana/prod:prod
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Build Docker Image)
[Pipeline] sh
+ docker build -t docker.io/iamkeerthana/prod:prod .
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  2.628MB
Step 1/4 : FROM nginx:alpine
 ---> 6769dc3a703c
Step 2/4 : COPY build /usr/share/nginx/html
 ---> Using cache
 ---> 7b68ac2c518b
Step 3/4 : EXPOSE 80
 ---> Using cache
 ---> 899448fef7dd
Step 4/4 : CMD ["nginx", "-g", "daemon off;"]
 ---> Using cache
 ---> 6a1928af572f
Successfully built 6a1928af572f
Successfully tagged iamkeerthana/prod:prod
[Pipeline] sh
 > git rev-parse --resolve-git-dir /home/ubuntu/jenkins-agent/workspace/React-App-Deployment/.git # timeout=10
 > git config remote.origin.url https://github.com/keerthana-v184/devops-build.git # timeout=10
Fetching upstream changes from https://github.com/keerthana-v184/devops-build.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
using GIT_ASKPASS to set credentials github-credentials
 > git fetch --tags --force --progress -- https://github.com/keerthana-v184/devops-build.git +refs/heads/*:refs/remotes/origin/* # timeout=10
Seen branch in repository origin/dev
Seen branch in repository origin/main
Seen 2 remote branches
 > git show-ref --tags -d # timeout=10
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 309d3430503ccb8ce3db3406075cadf2c4dd650f # timeout=10
+ docker image inspect docker.io/iamkeerthana/prod:prod
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Push to Docker Hub)
[Pipeline] withCredentials
Masking supported pattern matches of $DOCKER_PASS
[Pipeline] {
[Pipeline] sh
+ echo ****
+ docker login -u iamkeerthana --password-stdin
WARNING! Your password will be stored unencrypted in /home/ubuntu/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credential-stores

Login Succeeded
+ docker push docker.io/iamkeerthana/prod:prod
The push refers to repository [docker.io/iamkeerthana/prod]
680ccc09f3f7: Preparing
0d853d50b128: Preparing
947e805a4ac7: Preparing
811a4dbbf4a5: Preparing
b8d7d1d22634: Preparing
e244aa659f61: Preparing
c56f134d3805: Preparing
d71eae0084c1: Preparing
08000c18d16d: Preparing
e244aa659f61: Waiting
c56f134d3805: Waiting
d71eae0084c1: Waiting
08000c18d16d: Waiting
947e805a4ac7: Layer already exists
0d853d50b128: Layer already exists
811a4dbbf4a5: Layer already exists
680ccc09f3f7: Layer already exists
b8d7d1d22634: Layer already exists
c56f134d3805: Layer already exists
e244aa659f61: Layer already exists
d71eae0084c1: Layer already exists
08000c18d16d: Layer already exists
prod: digest: sha256:7fc66e1bb143696da89cfb4608430779913c75584f30ae22b7aa6e547ff353e1 size: 2199
[Pipeline] }
[Pipeline] // withCredentials
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Deploy App on Node)
[Pipeline] sh
+ docker pull docker.io/iamkeerthana/prod:prod
prod: Pulling from iamkeerthana/prod
Digest: sha256:7fc66e1bb143696da89cfb4608430779913c75584f30ae22b7aa6e547ff353e1
Status: Image is up to date for iamkeerthana/prod:prod
docker.io/iamkeerthana/prod:prod
+ docker stop react-app
react-app
+ docker rm react-app
react-app
+ docker run -d --name react-app -p 80:80 docker.io/iamkeerthana/prod:prod
a72293278167554e7684dbab83432a1b2fb35885cdd291d87f3c7652d25c312d
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] sh
+ docker logout
Removing login credentials for https://index.docker.io/v1/
[Pipeline] sh
+ docker rmi docker.io/iamkeerthana/prod:prod
Error response from daemon: conflict: unable to remove repository reference "docker.io/iamkeerthana/prod:prod" (must force) - container a72293278167 is using its referenced image 6a1928af572f
+ true
[Pipeline] cleanWs
[WS-CLEANUP] Deleting project workspace...
[WS-CLEANUP] Deferred wipeout is used...
[WS-CLEANUP] done
[Pipeline] echo
Successfully deployed docker.io/iamkeerthana/prod:prod on node-react-agent
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
